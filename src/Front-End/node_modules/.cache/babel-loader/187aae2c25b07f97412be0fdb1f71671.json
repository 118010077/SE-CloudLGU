{"remainingRequest":"F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\node_modules\\babel-loader\\lib\\index.js!F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\src\\store\\modules\\user.js","dependencies":[{"path":"F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\src\\store\\modules\\user.js","mtime":1650297032242},{"path":"F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\babel.config.js","mtime":1650206385790},{"path":"F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650207855744},{"path":"F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\node_modules\\babel-loader\\lib\\index.js","mtime":1650207856467},{"path":"F:\\CUHKSZ\\CSC4001\\Project\\SE-CloudLGU\\src\\Front-End\\node_modules\\eslint-loader\\index.js","mtime":1650207855929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgeyBsb2dpbiBhcyBfbG9naW4sIGdldEluZm8gYXMgX2dldEluZm8gfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwoKdmFyIGdldERlZmF1bHRTdGF0ZSA9IGZ1bmN0aW9uIGdldERlZmF1bHRTdGF0ZSgpIHsKICByZXR1cm4gewogICAgdG9rZW46IGdldFRva2VuKCksCiAgICBuYW1lOiAnJywKICAgIGVtYWlsOiAnJywKICAgIGludHJvOiAnJywKICAgIGF2YXRhcjogJycsCiAgICByb2xlczogW10KICB9Owp9OwoKdmFyIHN0YXRlID0gZ2V0RGVmYXVsdFN0YXRlKCk7CnZhciBtdXRhdGlvbnMgPSB7CiAgUkVTRVRfU1RBVEU6IGZ1bmN0aW9uIFJFU0VUX1NUQVRFKHN0YXRlKSB7CiAgICBPYmplY3QuYXNzaWduKHN0YXRlLCBnZXREZWZhdWx0U3RhdGUoKSk7CiAgfSwKICBTRVRfVE9LRU46IGZ1bmN0aW9uIFNFVF9UT0tFTihzdGF0ZSwgdG9rZW4pIHsKICAgIHN0YXRlLnRva2VuID0gdG9rZW47CiAgfSwKICBTRVRfTkFNRTogZnVuY3Rpb24gU0VUX05BTUUoc3RhdGUsIG5hbWUpIHsKICAgIHN0YXRlLm5hbWUgPSBuYW1lOwogIH0sCiAgU0VUX0VNQUlMOiBmdW5jdGlvbiBTRVRfRU1BSUwoc3RhdGUsIGVtYWlsKSB7CiAgICBzdGF0ZS5lbWFpbCA9IGVtYWlsOwogIH0sCiAgU0VUX0lOVFJPOiBmdW5jdGlvbiBTRVRfSU5UUk8oc3RhdGUsIGludHJvKSB7CiAgICBzdGF0ZS5pbnRybyA9IGludHJvOwogIH0sCiAgU0VUX0FWQVRBUjogZnVuY3Rpb24gU0VUX0FWQVRBUihzdGF0ZSwgYXZhdGFyKSB7CiAgICBzdGF0ZS5hdmF0YXIgPSBhdmF0YXI7CiAgfSwKICBTRVRfUk9MRVM6IGZ1bmN0aW9uIFNFVF9ST0xFUyhzdGF0ZSwgcm9sZXMpIHsKICAgIHN0YXRlLnJvbGVzID0gcm9sZXM7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICAvLyB1c2VyIGxvZ2luCiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKF9yZWYsIGxvZ2luRm9ybSkgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ2luKGxvZ2luRm9ybSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgY29uc29sZS5sb2coJy0tLWxvZ2luLS0tc3RvcmUvdXNlci5qczpsb2dpbi0tLScpOwogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgIGlmIChyZXMuZGF0YVsnc3VjY2VzcyddKSB7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIHJlcy5kYXRhWyd0b2tlbiddKTsKICAgICAgICAgIHNldFRva2VuKHJlcy5kYXRhWyd0b2tlbiddKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVqZWN0KCdsb2dpbiBmYWlsZWQnKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2dldEluZm8oc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGNvbnNvbGUubG9nKCctLS1zdG9yZS91c2VyLmpzOiBnZXRJbmZvLS0tJyk7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKCiAgICAgICAgaWYgKCFyZXMuZGF0YSkgewogICAgICAgICAgcmVqZWN0KCdWZXJpZmljYXRpb24gZmFpbGVkLCBwbGVhc2UgTG9naW4gYWdhaW4uJyk7CiAgICAgICAgfQoKICAgICAgICB2YXIgcm9sZSA9IFtyZXMuZGF0YVsndXNlcklkZW50aXR5J11dOyAvLyByb2xlcyBtdXN0IGJlIGEgbm9uLWVtcHR5IGFycmF5CgogICAgICAgIGlmICghcm9sZSB8fCByb2xlLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgICByZWplY3QoJ2dldEluZm86IHJvbGVzIG11c3QgYmUgYSBub24tbnVsbCBhcnJheSEnKTsKICAgICAgICB9CgogICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgcm9sZSk7CiAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIHJlcy5kYXRhWyd1c2VyTmFtZSddKTsKICAgICAgICBjb21taXQoJ1NFVF9FTUFJTCcsIHJlcy5kYXRhWyd1c2VyRW1haWwnXSk7CiAgICAgICAgY29tbWl0KCdTRVRfSU5UUk8nLCByZXMuZGF0YVsndXNlckludHJvJ10pOwogICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIHJlcy5kYXRhWyd1c2VyUGhvdG8nXSk7CiAgICAgICAgcmVzb2x2ZShyb2xlKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHVzZXIgbG9nb3V0CiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAoKICAgICAgcmVzZXRSb3V0ZXIoKTsKICAgICAgY29tbWl0KCdSRVNFVF9TVEFURScpOwogICAgICByZXNvbHZlKCk7CiAgICB9KTsKICB9LAogIC8vIHJlbW92ZSB0b2tlbgogIHJlc2V0VG9rZW46IGZ1bmN0aW9uIHJlc2V0VG9rZW4oX3JlZjQpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAoKICAgICAgY29tbWl0KCdSRVNFVF9TVEFURScpOwogICAgICByZXNvbHZlKCk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBzdGF0ZSwKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zCn07"},{"version":3,"sources":["F:/CUHKSZ/CSC4001/Project/SE-CloudLGU/src/Front-End/src/store/modules/user.js"],"names":["login","getInfo","getToken","setToken","removeToken","resetRouter","getDefaultState","token","name","email","intro","avatar","roles","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_EMAIL","SET_INTRO","SET_AVATAR","SET_ROLES","actions","loginForm","commit","Promise","resolve","reject","then","res","console","log","data","catch","error","role","length","logout","resetToken","namespaced"],"mappings":"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","sourcesContent":["import { login, getInfo } from '@/api/user'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\nimport { resetRouter } from '@/router'\r\n\r\nconst getDefaultState = () => {\r\n  return {\r\n    token: getToken(),\r\n    name: '',\r\n    email: '',\r\n    intro: '',\r\n    avatar: '',\r\n    roles: []\r\n  }\r\n}\r\n\r\nconst state = getDefaultState()\r\n\r\nconst mutations = {\r\n  RESET_STATE: (state) => {\r\n    Object.assign(state, getDefaultState())\r\n  },\r\n  SET_TOKEN: (state, token) => {\r\n    state.token = token\r\n  },\r\n  SET_NAME: (state, name) => {\r\n    state.name = name\r\n  },\r\n  SET_EMAIL: (state, email) => {\r\n    state.email = email\r\n  },\r\n  SET_INTRO: (state, intro) => {\r\n    state.intro = intro\r\n  },\r\n  SET_AVATAR: (state, avatar) => {\r\n    state.avatar = avatar\r\n  },\r\n  SET_ROLES: (state, roles) => {\r\n    state.roles = roles\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  // user login\r\n  login({ commit }, loginForm) {\r\n    return new Promise((resolve, reject) => {\r\n      login(loginForm).then(res => {\r\n        console.log('---login---store/user.js:login---')\r\n        console.log(res)\r\n        if (res.data['success']) {\r\n          commit('SET_TOKEN', res.data['token'])\r\n          setToken(res.data['token'])\r\n          resolve()\r\n        } else {\r\n          reject('login failed')\r\n        }\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // get user info\r\n  getInfo({ commit, state }) {\r\n    return new Promise((resolve, reject) => {\r\n      getInfo(state.token).then(res => {\r\n        console.log('---store/user.js: getInfo---')\r\n        console.log(res)\r\n\r\n        if (!res.data) {\r\n          reject('Verification failed, please Login again.')\r\n        }\r\n\r\n        var role = [res.data['userIdentity']]\r\n\r\n        // roles must be a non-empty array\r\n        if (!role || role.length <= 0) {\r\n          reject('getInfo: roles must be a non-null array!')\r\n        }\r\n\r\n        commit('SET_ROLES', role)\r\n        commit('SET_NAME', res.data['userName'])\r\n        commit('SET_EMAIL', res.data['userEmail'])\r\n        commit('SET_INTRO', res.data['userIntro'])\r\n        commit('SET_AVATAR', res.data['userPhoto'])\r\n        resolve(role)\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // user logout\r\n  logout({ commit }) {\r\n    return new Promise(resolve => {\r\n      removeToken() // must remove  token  first\r\n      resetRouter()\r\n      commit('RESET_STATE')\r\n      resolve()\r\n    })\r\n  },\r\n\r\n  // remove token\r\n  resetToken({ commit }) {\r\n    return new Promise(resolve => {\r\n      removeToken() // must remove  token  first\r\n      commit('RESET_STATE')\r\n      resolve()\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n\r\n"]}]}